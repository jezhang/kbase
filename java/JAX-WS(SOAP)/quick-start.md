快速开始
========
[Java API for XML Web Services(JAX-WS)](http://jax-ws.java.net/), 是一系列的API用来创建XML格式(SOAP)的web service，JAX-WS提供了许多注解来简化web service客户端和web service服务端的开发和部署工作。

<a name="rpcstyle"></a>
##JAX-WS hello world example - RPC style##
JDK 1.6绑定了JAX-WS，这意味着更容易去开发Java web service。这一节介绍如何完成下面的任务：
  1. 使用JAX-WS建立一个基于SOAP RPC的web service
  2. 手动建一个Java web service 客户端
  3. 使用**wsimport**工具创建一个Java web service客户端

###JAX-WS Web Service终端###
下面的步骤演示如何使用JAX-WS来创建一个RPC style web service终端

####1. 建立一个Web Service终端接口####
File : HelloWorld.java
```java
package info.woodchat.ws;

import javax.jws.WebMethod;
import javax.jws.WebService;
import javax.jws.soap.SOAPBinding;
import javax.jws.soap.SOAPBinding.Style;

@WebService
@SOAPBinding(style = Style.RPC)
public interface HelloWorld {
	@WebMethod String getHelloWorldAsString(String name);
}
```

####2. 创建一个Web Service终端实现####
File : HelloWorldImpl.java
```java
package info.woodchat.ws;

import javax.jws.WebService;

@WebService(endpointInterface = "info.woodchat.ws.HelloWorld")
public class HelloWorldImpl implements HelloWorld {
	@Override
	public String getHelloWorldAsString(String name) {
		return "Hello World JAX-WS " + name;
	}
}
```

####3. 创建一个终端发布####
File : HelloWorldPublisher.java
```java
package info.woodchat.ws;

import javax.xml.ws.Endpoint;

public class HelloWorldPublisher {
	public static void main(String[] args) {
		Endpoint.publish("http://localhost:9999/ws/helloworld", new HelloWorldImpl());
	}
}
```
运行终端发布，web service将会部署在URL "**http://localhost:9999/ws/hello**"

####4. 测试####
<a name="wsdl"></a>浏览器打开<http://localhost:9999/ws/hello?wsdl>
```xml

<?xml version="1.0" encoding="UTF-8"?>
<!-- Published by JAX-WS RI at http://jax-ws.dev.java.net. RI's version is JAX-WS RI 2.1.6 in JDK 6. -->
<!-- Generated by JAX-WS RI at http://jax-ws.dev.java.net. RI's version is JAX-WS RI 2.1.6 in JDK 6. -->
<definitions xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" xmlns:tns="http://ws.woodchat.info/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns="http://schemas.xmlsoap.org/wsdl/" targetNamespace="http://ws.woodchat.info/" name="HelloWorldImplService">
	<types></types>
	<message name="getHelloWorldAsString">
		<part name="arg0" type="xsd:string"></part>
	</message>
	<message name="getHelloWorldAsStringResponse">
		<part name="return" type="xsd:string"></part>
	</message>
	<portType name="HelloWorld">
		<operation name="getHelloWorldAsString">
			<input message="tns:getHelloWorldAsString"></input>
			<output message="tns:getHelloWorldAsStringResponse"></output>
		</operation>
	</portType>
	<binding name="HelloWorldImplPortBinding" type="tns:HelloWorld">
		<soap:binding transport="http://schemas.xmlsoap.org/soap/http" style="rpc"></soap:binding>
		<operation name="getHelloWorldAsString">
			<soap:operation soapAction=""></soap:operation>
			<input>
				<soap:body use="literal" namespace="http://ws.woodchat.info/"></soap:body>
			</input>
			<output>
				<soap:body use="literal" namespace="http://ws.woodchat.info/"></soap:body>
			</output>
		</operation>
	</binding>
	<service name="HelloWorldImplService">
		<port name="HelloWorldImplPort" binding="tns:HelloWorldImplPortBinding">
			<soap:address location="http://localhost:9999/ws/hello"></soap:address>
		</port>
	</service>
</definitions>
```

###JAX-WS Web Service客户端###
好的，web service已经部署，我们现在来创建web service客户端访问发布的web service终端

####1. Java Web Service客户端####
手动创建一个Java web service客户端
```java
package info.woodchat.ws;

import java.net.URL;

import javax.xml.namespace.QName;
import javax.xml.ws.Service;

public class HelloWorldClient {
	public static void main(String[] args) throws Exception {
		URL url = new URL("http://localhost:9999/ws/hello?wsdl");
		QName qname = new QName("http://ws.woodchat.info/", "HelloWorldImplService");
		Service service = Service.create(url,qname);
		HelloWorld hello = service.getPort(HelloWorld.class);
		System.out.println(hello.getHelloWorldAsString("jezhang"));
	}
}
```
输出
```sh
Hello World JAX-WS jezhang
```

####2. 使用**wsimport**工具创建Java Web Service客户端####
你还可以使用"**wsimport**"来解析发布的wsdl文件，会生成必要的客户端文件(stub)来访问发布的web service。

> **wsimport**工具在"JDK_PATH/bin"文件夹找到

使用"**wsimport**命令"
```sh
wsimport -keep http://localhost:9999/ws/hello?wsdl
```
这将会生成一些必须的客户端文件，会生成一个接口和一个service实现文件
```java
// HelloWorld.java
package info.woodchat.ws;

import javax.jws.WebMethod;
import javax.jws.WebParam;
import javax.jws.WebResult;
import javax.jws.WebService;
import javax.jws.soap.SOAPBinding;

@WebService(name = "HelloWorld", targetNamespace = "http://ws.woodchat.info/")
@SOAPBinding(style = SOAPBinding.Style.RPC)
public interface HelloWorld {
    @WebMethod
    @WebResult(partName = "return")
    public String getHelloWorldAsString(@WebParam(name = "arg0", partName = "arg0") String arg0);
}

// HelloWorldImplService.java
package info.woodchat.ws;

import java.net.MalformedURLException;
import java.net.URL;
import java.util.logging.Logger;
import javax.xml.namespace.QName;
import javax.xml.ws.Service;
import javax.xml.ws.WebEndpoint;
import javax.xml.ws.WebServiceClient;
import javax.xml.ws.WebServiceFeature;

@WebServiceClient(name = "HelloWorldImplService", targetNamespace = "http://ws.woodchat.info/", wsdlLocation = "http://localhost:9999/ws/hello?wsdl")
public class HelloWorldImplService extends Service {
    private final static URL HELLOWORLDIMPLSERVICE_WSDL_LOCATION;
    private final static Logger logger = Logger.getLogger(info.woodchat.ws.HelloWorldImplService.class.getName());
    static {
        URL url = null;
        try {
            URL baseUrl;
            baseUrl = info.woodchat.ws.HelloWorldImplService.class.getResource(".");
            url = new URL(baseUrl, "http://localhost:9999/ws/hello?wsdl");
        } catch (MalformedURLException e) {
            logger.warning("Failed to create URL for the wsdl Location: 'http://localhost:9999/ws/hello?wsdl', retrying as a local file");
            logger.warning(e.getMessage());
        }
        HELLOWORLDIMPLSERVICE_WSDL_LOCATION = url;
    }

    public HelloWorldImplService(URL wsdlLocation, QName serviceName) {
        super(wsdlLocation, serviceName);
    }

    public HelloWorldImplService() {
        super(HELLOWORLDIMPLSERVICE_WSDL_LOCATION, new QName("http://ws.woodchat.info/", "HelloWorldImplService"));
    }

    @WebEndpoint(name = "HelloWorldImplPort")
    public HelloWorld getHelloWorldImplPort() {
        return super.getPort(new QName("http://ws.woodchat.info/", "HelloWorldImplPort"), HelloWorld.class);
    }

    @WebEndpoint(name = "HelloWorldImplPort")
    public HelloWorld getHelloWorldImplPort(WebServiceFeature... features) {
        return super.getPort(new QName("http://ws.woodchat.info/", "HelloWorldImplPort"), HelloWorld.class, features);
    }
}

```
现在，建一个Java web service客户端基于上面生成的文件。
```java
package info.woodchat.client;
 
import info.woodchat.ws.HelloWorld;
import info.woodchat.ws.HelloWorldImplService;
 
public class HelloWorldClient{ 
	public static void main(String[] args) { 
		HelloWorldImplService helloService = new HelloWorldImplService();
		HelloWorld hello = helloService.getHelloWorldImplPort(); 
		System.out.println(hello.getHelloWorldAsString("jezhang")); 
    } 
}
```
输出
```sh
Hello World JAX-WS jezhang
```

###跟踪SOAP###
```java
URL url = new URL("http://localhost:9999/ws/hello?wsdl");
QName qname = new QName("http://ws.woodchat.info/", "HelloWorldImplService");
Service service = Service.create(url, qname);
HelloWorld hello = service.getPort(HelloWorld.class);
System.out.println(hello.getHelloWorldAsString("jezhang"));
```

####1. 请求一个WSDL文件####
首先，客户端发送一个wsdl请求到service端， HTTP traffic:
```sh
GET /ws/hello?wsdl HTTP/1.1
User-Agent: Java/1.6.0_13
Host: localhost:9999
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Connection: keep-alive
```

服务器相应，请参考上文中[wsdl](#user-content-wsdl)部分

####2. hello.getHelloWorldAsString()####
第2个请求，客户端放入调用方法请求到SOAP信封并且发送到服务端。在服务端，调用请求的方法并且把结果放进一个SOAP信封返回客户端
```xml
POST /ws/hello HTTP/1.1
SOAPAction: ""
Accept: text/xml, multipart/related, text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Content-Type: text/xml; charset=utf-8
User-Agent: Java/1.6.0_13
Host: localhost:9999
Connection: keep-alive
Content-Length: 224

<?xml version="1.0" ?>
<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
	<S:Body>
		<ns2:getHelloWorldAsString xmlns:ns2="http://ws.woodchat.info/">
			<arg0>jezhang</arg0>
		</ns2:getHelloWorldAsString>
	</S:Body>
</S:Envelope>
```

服务器返回结果：
```xml
HTTP/1.1 200 OK
Transfer-encoding: chunked
Content-type: text/xml; charset=utf-8
 
<?xml version="1.0" ?>
	<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
		<S:Body>
			<ns2:getHelloWorldAsStringResponse xmlns:ns2="http://ws.woodchat.info/">
				<return>Hello World JAX-WS jezhang</return>
			</ns2:getHelloWorldAsStringResponse>
		</S:Body>
	</S:Envelope>
```

完成。

##JAX-WS Hello World Example – Document Style##
在这一节的教程里，我们演示如何使用JAX-WS来闯一个一个基于SOAP的web service(文档)终端，对比 [RPC Style](#user-content-rpcstyle)，需要一些额外的工作量。
###JAX-WS Web Service End Point###

####1.建立一个Web Service终端接口####
实际上，```@SOAPBinding```注解是可选的，默认style就是文档
File : HelloWorld.java
````java

```

##How to trace SOAP message in Eclipse IDE##

##JAX-WS : wsimport tool example##

##JAX-WS : wsgen tool example##

